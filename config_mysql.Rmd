---
title: "DBMS 환경 설정"
description: |
   **ecoDI 패키지와 ecoDI Manager**가 동작할 **MySQL 서버**에 환경설정하는 방법을 살펴봅니다.
author:
  - name: 유충현 
    url: https://choonghyunryu.github.io/
    affiliation: 디플래닉스 DS
    affiliation_url: https://www.dplanex.com/
date: "`r Sys.Date()`"
output: 
  distill::distill_article:
    toc: true
    toc_depth: 3  
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                      message = FALSE, 
                      warning = FALSE, 
                      collapse = FALSE,
                      fig.align = "center",
                      tidy.opts = list(width.cutoff = 70), 
                      tidy = TRUE)
knitr::opts_chunk$set(fig.width = 12, fig.height = 9)

library(shiny, warn.conflicts = FALSE)
library(dplyr, warn.conflicts = FALSE)
library(ggplot2, warn.conflicts = FALSE)

xaringanExtra :: use_panelset()
```


```{r}
#| intro, 
#| echo=FALSE, 
#| out.width = "45%"
knitr::include_graphics("img/config_dbms.png")
```


```{r, preface, echo=FALSE}
div(class = "preface", 
    h4("들어가기"),
    "DBMS 설치로 기초 준비는 되었지만, 사용 환경을 설정해야 합니다.", br(),
    strong("사용자 계정을 생성하고 DB 스키마를 생성"), "합니다.", br(), 
    "그리고 ", strong("ecoDI 메타 테이블을 생성하고, 초기 데이터를 마이그레이션"), "해야 기초 설정이 마무리됩니다.")
```

<br>


## MySQL 사용자 환경 설정하기

Amazon Linux 2023의 패키지 관리자는 `dnf`입니다. `dnf`를 이용하여 MySQL Server를 설치합니다.

### MySQL 접속하기

**root 계정**으로 mysql 명령어로 MySQL 서버에 접속합니다. 이때, **`--local-infile=1` 옵션을 설정하여, 로컬 파일 임포트를 허용합니다.**

```{bash, eval=FALSE}
mysql -u root -p --local-infile=1
```


### 사용자 생성하기

`create user` 명령어로 `ecodi` 사용자를 생성합니다. 패스워드는 보안상 에스터리스크(*)로 표현하였습니다.

```{bash, eval=FALSE}
create user 'ecodi'@'localhost' identified by '*******';
grant all privileges on *.* to 'ecodi'@'localhost';
FLUSH PRIVILEGES;
```


### DB 스키마 생성하기

`ecodi_meta`, `ecodi_ods`, `ecodi_data` 3개의 DB 스키마를 생성합니다. 각 스키마의 문자셋은 `utf8mb3`, 콜레이션은 `utf8mb3_general_ci`로 설정합니다.

```{bash, eval=FALSE}
CREATE SCHEMA ecodi_meta DEFAULT CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci;
CREATE SCHEMA ecodi_ods DEFAULT CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci;
CREATE SCHEMA ecodi_data DEFAULT CHARACTER SET utf8mb3 COLLATE utf8mb3_general_ci;
```

<br>

3개의 DB 스키마의 역할은 다음과 같습니다.


```{r schema, echo=FALSE, fig.cap='ecoDI의 DB 스키마 구성', out.width = "80%"}
knitr::include_graphics("img/schema.png")
```


