---
title: "환경 설정"
description: |
  일선에 배포할 통계분석 **보고서의 핵심은 비즈니스 인사이트의 제공**에 있습니다. **그러나** 인사이트 발굴을 위한 분석가의 노력과 더불어 보고서 서식을 만들고, 시각화 결과를 옮겨서 **문서를 편집하는 일련의 작업들에도 많은 리소스가 소비**됩니다. 이와 같은 **휴먼 리소스의 소비를 줄이고자 보고서 (반)자동화 방안을 고찰**합니다.
site: distill::distill_website
output:
  distill::distill_article:
    toc: true
    toc_depth: 3  
author:
  - name: 유충현 
    url: https://choonghyunryu.github.io/
    affiliation: 디플래닉스 DS
    affiliation_url: https://www.dplanex.com/    
date: "`r Sys.Date()`"  
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```


# 설치 환경

### EC2
본 패키지는 AWS EC2 크롤러 서버에 설치함을 전제로 설명합니다.

AWS EC2 정보는 다음과 같습니다.:

- 인스턴스명: prd-extdata-crawler-ec2-new
- 인스턴스 ID: i-0fcad0ec03eff8831
- 퍼블릭 IPv4 주소: 3.39.196.148

<br>

```{r digital, echo=FALSE, out.width = "85%", fig.align='center'}
knitr::include_graphics("img/aws_crawler.png")
```

<br>

### 운영체제 정보

크롤러 서버의 운영체제는 Amazon Linux 2023입니다. 다음은 운영체제 정보입니다.

```{bash, eval=FALSE, echo=TRUE}
sh-5.2$ cat /etc/os-release
NAME="Amazon Linux"
VERSION="2023"
ID="amzn"
ID_LIKE="fedora"
VERSION_ID="2023"
PLATFORM_ID="platform:al2023"
PRETTY_NAME="Amazon Linux 2023.3.20240304"
ANSI_COLOR="0;33"
CPE_NAME="cpe:2.3:o:amazon:amazon_linux:2023"
HOME_URL="https://aws.amazon.com/linux/amazon-linux-2023/"
DOCUMENTATION_URL="https://docs.aws.amazon.com/linux/"
SUPPORT_URL="https://aws.amazon.com/premiumsupport/"
BUG_REPORT_URL="https://github.com/amazonlinux/amazon-linux-2023"
VENDOR_NAME="AWS"
VENDOR_URL="https://aws.amazon.com/"
SUPPORT_END="2028-03-15"
```


# R 환경 설정

## R 설치

dnf 패키지 관리자를 이용해서 R을 설치합니다.

```{bash, eval=FALSE, echo=TRUE}
sudo dnf install -y R
```


## R Studio Server설치

크롤링 서버에 R Studio Server를 설치합니다. 

R Studio Server는 op`enssl`을 사용하므로 OpenSSL 1.1.1 버전을 별도로 설치합니다.

```{bash, eval=FALSE, echo=TRUE}
wget https://download2.rstudio.org/server/rhel8/x86_64/rstudio-server-rhel-2025.05.0-496-x86_64.rpm
sudo dnf install rstudio-server-rhel-2025.05.0-496-x86_64.rpm

sudo dnf install -y wget perl unzip gcc zlib-devel
mkdir /tmp/openssl
cd /tmp/openssl
wget https://www.openssl.org/source/openssl-1.1.1s.tar.gz
tar xzvf openssl-1.1.1s.tar.gz
cd openssl-1.1.1s
./config --prefix=/usr/local/openssl11 --openssldir=/usr/local/openssl11 shared zlib
make
sudo make install

sudo bash -c "echo /usr/local/openssl11/lib/ >> /etc/ld.so.conf"
sudo ldconfig
```


## R 패키지 설치

### 사전 유틸리티 설치

```bash
sudo yum install libcurl-devel.x86_64
sudo yum install openssl-devel.x86_64
sudo yum install fribidi-devel.x86_64
sudo yum install freetype-devel libpng-devel libtiff-devel libjpeg-devel

sudo ln -s /usr/lib64/libssl.so.3.0.8 /usr/lib64/libssl.so.1.1 
sudo ln -s /usr/lib64/libcrypto.so.3.0.8 /usr/lib64/libcrypto.so.1.1  
```

### R 패키지 설치
```r
# from CRAN --------------------------------------------------------------------
pkgs <- c("tidyverse", "readxl", "devtools", "formattable", "archive", "RCurl", 
          "RMySQL", "R.utils", "shinyWidgets", "shinydashboard",
          "shinydashboardPlus", "shinybusy", "colourpicker", "htmltools", 
          "flextable", "openxlsx", "ggridges")

install_if_missing <- function(pkg) {
  if (!requireNamespace(pkg, quietly = TRUE)) {
    install.packages(pkg)
  }
}
invisible(lapply(pkgs, install_if_missing))

# from GitHub ------------------------------------------------------------------
devtools::install_github("choonghyunryu/koscrap")
devtools::install_github("choonghyunryu/dpxReport")
```

# 기타 유틸리티 설치

## Chrome 설치

PageJS 기반 보고서 자동화 기능이 있는 패키지를 설치하기 위해서 Chrome 브라우저를 설치합니다. `dlookr` 패키지가 여기에 해당합니다.

```bash
wget https://dl.google.com/linux/direct/google-chrome-stable_current_x86_64.rpm
sudo dnf install ./google-chrome-stable_current_x86_64.rpm
google-chrome --version
```